<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="https://miro.com/app/static/styles.1.0.css" />
</head>

<body>
  <script src="https://miro.com/app/static/sdk.1.1.js"></script>
  <script src="main.js"></script>

  <div class="miro-h2">Settings</div>

  <div class="miro-input-field miro-input-field--small">
    <label>codeBeamer Address</label>
    <input id='cbAddress' type="text" class="miro-input miro-input--primary" placeholder="https://codebeamer.com/cb">
  </div>
  <div class="miro-input-field miro-input-field--small">
    <label>codeBeamer Username</label>
    <input id='cbUsername' type="text" class="miro-input miro-input--primary" placeholder="Username">
  </div>
  <div class="miro-input-field miro-input-field--small">
    <label>codeBeamer Password</label>
    <input id='cbPassword' type="password" class="miro-input miro-input--primary" placeholder="**********">
  </div>

  <button id='saveButton' class="miro-btn miro-btn--primary miro-btn--small">Save</button>
  <script>
    getPrivateSetting('cbUsername').then(username => {
      console.log(`cbUsername: ${username}`)
      if (username)
        document.querySelector('#cbUsername').value = username
    })

    document.querySelector('#saveButton').addEventListener('click', () =>
      Promise.all([
        saveBoardSettings({
          cbAddress: document.querySelector('#cbAddress').value
        }),
        savePrivateSettings({
          cbUsername: document.querySelector('#cbUsername').value,
          cbPassword: document.querySelector('#cbPassword').value,
        })
      ])
    )
  </script>
</body>

</html>